@model BMEDmgt.Areas.MedEngMgt.Models.AssetPContractPermit
<script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>
<script>
    $(function () {

        $("#BtnCreatePermit").click(function () {
            var v1 = $("#PurchaseNo").val();
            var v2 = $("#PermitNo").val();
            var v3 = $("#PermitValid").val();
            //console.log("v1:" + v1 + "v2:" + v2 + "v3" + v3);
            $.ajax({
                url: "../AssetPurchaseContracts/CreatePermit",
                type: "POST",
                data: { 'purchaseNo': v1, 'permitNo': v2, 'permitValid': v3 },
                async: false,
                dataType: "json",
                success: function (data) {
                    if (!data.success)
                        alert(data.error);
                    else {
                        alert("新增成功!");
                    }
                }
            });
            $.ajax({
                url: "../AssetPurchaseContracts/GetPermitList",
                type: "GET",
                data: { 'purchaseNo': v1 },
                async: false,
                success: function (data) {
                    $("#permitListPnl").html(data);
                }
            });
        });

    });
</script>

<div class="form-horizontal panel panel-default">
    <h4>新增衛署登記證</h4>
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    @Html.HiddenFor(model => model.PurchaseNo, new { id = "permitPNO" })

    <div class="form-group">
        @Html.LabelFor(model => model.PermitNo, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.PermitNo, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.PermitNo, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.PermitValid, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.PermitValid, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.PermitValid, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input id="BtnCreatePermit" type="button" value="新增" class="btn btn-default" />
            <img id="imgLOADING2" src="~/Images/opc-ajax-loader.gif" style="display: none" />
        </div>
    </div>
</div>


<div id="permitListPnl">

</div>